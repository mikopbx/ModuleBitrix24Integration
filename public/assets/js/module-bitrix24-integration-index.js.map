{"version":3,"sources":["src/module-bitrix24-integration-index.js"],"names":["ModuleBitrix24Integration","$formObj","$","$submitButton","$statusToggle","$moduleStatus","$dirrtyField","$usersCheckBoxes","$globalSearch","$recordsTable","$addNewButton","$elRegion","$elAppData","inputNumberJQTPL","$maskList","getNewRecordsAJAXUrl","globalRootUrl","validateRules","portal","identifier","rules","type","prompt","globalTranslate","mod_b24_i_ValidatePortalEmpty","client_id","depends","mod_b24_i_ValidateClientIDEmpty","client_secret","mod_b24_i_ValidateClientSecretEmpty","onChangeRegion","region","val","form","show","hide","onChangeField","updateAuthInfo","e","data","originalEvent","code","undefined","post","result","console","log","popup","close","checkbox","initialize","checkStatusToggle","window","addEventListener","initializeForm","dropdown","change","each","attr","tab","DataTable","lengthChange","paging","columns","orderable","searchable","drawCallback","index","obj","values","makeDropdownList","onChange","changeCardModeInList","text","parent","order","language","SemanticLocalization","dataTableLocalisation","bind","on","Config","pbxUrl","url","open","Math","random","trigger","onChecked","number","removeClass","onUnchecked","addClass","keyCode","length","applyFilter","dataTable","serverSide","processing","ajax","dataSrc","sDom","deferRender","pageLength","bAutoWidth","createdRow","row","templateDisable","disabled","templateName","name","templateNumber","templateDid","alias","templateDeleteButton","id","bt_ToolTipDelete","eq","html","initializeInputmask","find","Form","checkValues","ordering","target","transition","closest","preventDefault","remove","append","floor","rowTemplate","before","focus","selected","push","value","$choice","ModuleBitrix24IntegrationStatusWorker","$el","masksSort","InputMaskPatterns","inputmasks","inputmask","definitions","validator","cardinality","showMaskOnHover","oncomplete","cbOnCompleteNumber","onBeforePaste","cbOnNumberBeforePaste","match","replace","list","listKey","pastedValue","didEl","cbBeforeSendForm","settings","arrExternalLines","externalLines","JSON","stringify","arrUsers","uname","user_id","open_card_mode","cbAfterSendForm","document","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright © MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Alexey Portnov, 5 2020\n */\n\n/* global globalRootUrl, globalTranslate, Form, SemanticLocalization, InputMaskPatterns  */\n\nconst ModuleBitrix24Integration = {\n\t$formObj: $('#module-bitrix24-integration-form'),\n\t$submitButton: $('#submitbutton'),\n\t$statusToggle: $('#module-status-toggle'),\n\t$moduleStatus: $('#status'),\n\t$dirrtyField: $('#dirrty'),\n\t$usersCheckBoxes: $('#extensions-table .checkbox'),\n\n\t$globalSearch: $('#globalsearch'),\n\t$recordsTable: $('#external-line-table'),\n\t$addNewButton: $('#add-new-external-line-button'),\n\t$elRegion: $('#b24_region'),\n\t$elAppData: $('#b24-app-data'),\n\n\tinputNumberJQTPL: 'input.external-number',\n\t$maskList: null,\n\tgetNewRecordsAJAXUrl: `${globalRootUrl}module-bitrix24-integration/getExternalLines`,\n\n\tvalidateRules: {\n\t\tportal: {\n\t\t\tidentifier: 'portal',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_b24_i_ValidatePortalEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tclient_id: {\n\t\t\tidentifier: 'client_id',\n\t\t\tdepends: 'isREST',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_b24_i_ValidateClientIDEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tclient_secret: {\n\t\t\tidentifier: 'client_secret',\n\t\t\tdepends: 'isREST',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.mod_b24_i_ValidateClientSecretEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\tonChangeRegion(){\n\t\tlet region = ModuleBitrix24Integration.$elRegion.val();\n\t\tif(region === 'REST_API'){\n\t\t\tModuleBitrix24Integration.$formObj.form('set value', 'isREST', true);\n\t\t\tModuleBitrix24Integration.$elAppData.show();\n\t\t}else{\n\t\t\tModuleBitrix24Integration.$formObj.form('set value', 'isREST', '');\n\t\t\tModuleBitrix24Integration.$elAppData.hide();\n\t\t}\n\t\tModuleBitrix24Integration.onChangeField();\n\t},\n\n\tupdateAuthInfo(e) {\n\t\tlet data = e.originalEvent.data;\n\t\tif(typeof data !== 'string' && data.code !== undefined){\n\t\t\tdata.region = ModuleBitrix24Integration.$elRegion.val();\n\t\t\t$.post(`${globalRootUrl}module-bitrix24-integration/activateCode`, data, function( result ) {\n\t\t\t\tconsole.log(result);\n\t\t\t});\n\t\t\tModuleBitrix24Integration.popup.close();\n\t\t}\n\t},\n\n\tonChangeField(){\n\t\tif($('#create-lead').checkbox('is checked')){\n\t\t\t$('#lead-type').show()\n\t\t}else{\n\t\t\t$('#lead-type').hide()\n\t\t}\n\t},\n\tinitialize() {\n\t\tModuleBitrix24Integration.checkStatusToggle();\n\t\twindow.addEventListener('ModuleStatusChanged', ModuleBitrix24Integration.checkStatusToggle);\n\t\tModuleBitrix24Integration.initializeForm();\n\t\t$('.dropdown').dropdown();\n\n\t\tModuleBitrix24Integration.onChangeRegion();\n\t\tModuleBitrix24Integration.onChangeField();\n\t\tModuleBitrix24Integration.$elRegion.change(ModuleBitrix24Integration.onChangeRegion);\n\n\t\t$('.avatar').each(() => {\n\t\t\tif ($(this).attr('src') === '') {\n\t\t\t\t$(this).attr('src', `${globalRootUrl}assets/img/unknownPerson.jpg`);\n\t\t\t}\n\t\t});\n\n\t\t$('#extensions-menu .item').tab();\n\n\t\t$('#extensions-table').DataTable({\n\t\t\tlengthChange: false,\n\t\t\tpaging: false,\n\t\t\tcolumns: [\n\t\t\t\t{ orderable: false, searchable: false },\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t],\n\t\t\t/**\n\t\t\t * Draw event - fired once the table has completed a draw.\n\t\t\t */\n\t\t\tdrawCallback() {\n\t\t\t\t$('#extensions-table .select-group').each((index, obj) => {\n\t\t\t\t\t$(obj).dropdown({\n\t\t\t\t\t\tvalues: ModuleBitrix24Integration.makeDropdownList($(obj).attr('data-value')),\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\t$('#extensions-table .select-group').dropdown({\n\t\t\t\t\tonChange: ModuleBitrix24Integration.changeCardModeInList,\n\t\t\t\t});\n\n\t\t\t\t$('#extensions-table div.text').each((index, obj) => {\n\t\t\t\t\t$(obj).text(globalTranslate['mod_b24_i_OPEN_CARD_'+$(obj).parent().attr('data-value')]);\n\t\t\t\t});\n\t\t\t},\n\t\t\torder: [1, 'asc'],\n\t\t\tlanguage: SemanticLocalization.dataTableLocalisation,\n\t\t});\n\t\t$(window).bind('message',  ModuleBitrix24Integration.updateAuthInfo);\n\t\t$(\"#login-button\").on('click', function (e) {\n\t\t\tlet portal       = $('#portal').val();\n\t\t\t$.post(`${Config.pbxUrl}/admin-cabinet/module-bitrix24-integration/getAppId`, {'region': $('#b24_region').val()}, function( data ) {\n\t\t\t\tlet url \t\t = `https://${portal}/oauth/authorize/?client_id=${data.client_id}&`;\n\t\t\t\tModuleBitrix24Integration.popup = window.open(url, 'Auth', 'scrollbars, status, resizable, width=750, height=580');\n\t\t\t});\n\t\t});\n\t\t$('#create-lead').checkbox({\n\t\t\tonChange() {\n\t\t\t\tModuleBitrix24Integration.onChangeField()\n\t\t\t}\n\t\t});\n\t\tModuleBitrix24Integration.$usersCheckBoxes.checkbox({\n\t\t\tonChange() {\n\t\t\t\tModuleBitrix24Integration.$dirrtyField.val(Math.random());\n\t\t\t\tModuleBitrix24Integration.$dirrtyField.trigger('change');\n\t\t\t\tModuleBitrix24Integration.onChangeField()\n\t\t\t},\n\t\t\tonChecked() {\n\t\t\t\tconst number = $(this).attr('data-value');\n\t\t\t\t$(`#${number} .disability`).removeClass('disabled');\n\t\t\t},\n\t\t\tonUnchecked() {\n\t\t\t\tconst number = $(this).attr('data-value');\n\t\t\t\t$(`#${number} .disability`).addClass('disabled');\n\t\t\t},\n\t\t});\n\t\tModuleBitrix24Integration.$usersCheckBoxes.checkbox('attach events', '.check.button', 'check');\n\t\tModuleBitrix24Integration.$usersCheckBoxes.checkbox('attach events', '.uncheck.button', 'uncheck');\n\n\t\tModuleBitrix24Integration.$globalSearch.on('keyup', (e) => {\n\t\t\tif (e.keyCode === 13\n\t\t\t\t|| e.keyCode === 8\n\t\t\t\t|| ModuleBitrix24Integration.$globalSearch.val().length === 0) {\n\t\t\t\tconst text = `${ModuleBitrix24Integration.$globalSearch.val()}`;\n\t\t\t\tModuleBitrix24Integration.applyFilter(text);\n\t\t\t}\n\t\t});\n\n\t\tModuleBitrix24Integration.$recordsTable.dataTable({\n\t\t\tserverSide: true,\n\t\t\tprocessing: true,\n\t\t\tajax: {\n\t\t\t\turl: ModuleBitrix24Integration.getNewRecordsAJAXUrl,\n\t\t\t\ttype: 'POST',\n\t\t\t\tdataSrc: 'data',\n\t\t\t},\n\t\t\tcolumns: [\n\t\t\t\t{ data: null },\n\t\t\t\t{ data: 'name' },\n\t\t\t\t{ data: 'number' },\n\t\t\t\t{ data: 'alias' },\n\t\t\t\t{ data: null },\n\t\t\t],\n\t\t\tpaging: true,\n\t\t\t// scrollY: $(window).height() - ModuleBitrix24Integration.$recordsTable.offset().top-200,\n\t\t\t// stateSave: true,\n\t\t\tsDom: 'rtip',\n\t\t\tdeferRender: true,\n\t\t\tpageLength: 17,\n\t\t\tbAutoWidth: false,\n\n\t\t\t// scrollCollapse: true,\n\t\t\t// scroller: true,\n\t\t\t/**\n\t\t\t * Конструктор строки записи\n\t\t\t * @param row\n\t\t\t * @param data\n\t\t\t */\n\t\t\tcreatedRow(row, data) {\n\t\t\t\tconst templateDisable = '<div class=\"ui fitted toggle checkbox\">\\n' +\n\t\t\t\t\t'                <input type=\"checkbox\" '+((data.disabled==='0')?'checked=\"\"':'')+' tabindex=\"0\" class=\"hidden\"> <label></label>\\n' +\n\t\t\t\t\t'                </div>';\n\t\t\t\tconst templateName =\n\t\t\t\t\t'<div class=\"ui transparent fluid input inline-edit\">' +\n\t\t\t\t\t`<input class=\"external-name\" type=\"text\" data-value=\"${data.name}\" value=\"${data.name}\">` +\n\t\t\t\t\t'</div>';\n\n\t\t\t\tconst templateNumber =\n\t\t\t\t\t'<div class=\"ui transparent fluid input inline-edit\">' +\n\t\t\t\t\t`<input class=\"external-number\" type=\"text\" data-value=\"${data.number}\" value=\"${data.number}\">` +\n\t\t\t\t\t'</div>';\n\n\t\t\t\tconst templateDid =\n\t\t\t\t\t'<div class=\"ui transparent input inline-edit\">' +\n\t\t\t\t\t`<input class=\"external-aliases\" type=\"text\" data-value=\"${data.alias}\" value=\"${data.alias}\">` +\n\t\t\t\t\t'</div>';\n\n\t\t\t\tconst templateDeleteButton = '<div class=\"ui small basic icon buttons action-buttons\">' +\n\t\t\t\t\t`<a href=\"#\" data-value = \"${data.id}\"` +\n\t\t\t\t\t` class=\"ui button delete two-steps-delete popuped\" data-content=\"${globalTranslate.bt_ToolTipDelete}\">` +\n\t\t\t\t\t'<i class=\"icon trash red\"></i></a></div>';\n\n\t\t\t\t$('td', row).eq(0).html(templateDisable);\n\t\t\t\t$('td', row).eq(1).html(templateName);\n\t\t\t\t$('td', row).eq(2).html(templateNumber);\n\t\t\t\t$('td', row).eq(3).html(templateDid);\n\t\t\t\t$('td', row).eq(4).html(templateDeleteButton);\n\t\t\t},\n\t\t\t/**\n\t\t\t * Draw event - fired once the table has completed a draw.\n\t\t\t */\n\t\t\tdrawCallback() {\n\t\t\t\tModuleBitrix24Integration.initializeInputmask($(ModuleBitrix24Integration.inputNumberJQTPL));\n\t\t\t\tModuleBitrix24Integration.$recordsTable.find('div.checkbox').checkbox(\n\t\t\t\t\t{\n\t\t\t\t\t\tonChange() {\n\t\t\t\t\t\t\tForm.$formObj.form('set value', 'dirrty', Math.random());\n\t\t\t\t\t\t\tForm.checkValues();\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\tlanguage: SemanticLocalization.dataTableLocalisation,\n\t\t\tordering: false,\n\t\t});\n\t\tModuleBitrix24Integration.dataTable = ModuleBitrix24Integration.$recordsTable.DataTable();\n\n\t\t// Двойной клик на поле ввода номера\n\t\t$('body').on('focusin', '.external-name, .external-number, .external-aliases ', (e) => {\n\t\t\t$(e.target).transition('glow');\n\t\t\t$(e.target).closest('div')\n\t\t\t\t.removeClass('transparent')\n\t\t\t\t.addClass('changed-field');\n\t\t\t$(e.target).attr('readonly', false);\n\t\t\tModuleBitrix24Integration.$dirrtyField.val(Math.random());\n\t\t\tModuleBitrix24Integration.$dirrtyField.trigger('change');\n\n\t\t\tForm.$formObj.form('set value', 'dirrty', Math.random());\n\t\t\tForm.checkValues();\n\t\t});\n\n\t\t// Отправка формы на сервер по уходу с поля ввода\n\t\t$('body').on('focusout', '.external-name, .external-number, .external-aliases', (e) => {\n\t\t\t$(e.target).closest('div')\n\t\t\t\t.addClass('transparent')\n\t\t\t\t.removeClass('changed-field');\n\t\t\t$(e.target).attr('readonly', true);\n\t\t\tModuleBitrix24Integration.$dirrtyField.val(Math.random());\n\t\t\tModuleBitrix24Integration.$dirrtyField.trigger('change');\n\n\t\t\tForm.$formObj.form('set value', 'dirrty', Math.random());\n\t\t\tForm.checkValues();\n\t\t});\n\n\t\t// Клик на кнопку удалить\n\t\t$('body').on('click', 'a.delete', (e) => {\n\t\t\te.preventDefault();\n\t\t\t$(e.target).closest('tr').remove();\n\t\t\tif (ModuleBitrix24Integration.$recordsTable.find('tbody > tr').length===0){\n\t\t\t\tModuleBitrix24Integration.$recordsTable.find('tbody').append('<tr class=\"odd\"></tr>');\n\t\t\t}\n\t\t\tModuleBitrix24Integration.$dirrtyField.val(Math.random());\n\t\t\tModuleBitrix24Integration.$dirrtyField.trigger('change');\n\t\t});\n\n\t\t// Добавление новой строки\n\t\tModuleBitrix24Integration.$addNewButton.on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\t$('.dataTables_empty').remove();\n\t\t\tconst id = `new${Math.floor(Math.random() * Math.floor(500))}`;\n\t\t\tconst rowTemplate = `<tr id=\"${id}\" class=\"ext-line-row\">` +\n\t\t\t\t'<td><i class=\"ui user circle icon\"></i></td>' +\n\t\t\t\t'<td><div class=\"ui fluid input inline-edit changed-field\"><input class=\"external-name\" type=\"text\" data-value=\"\" value=\"\"></div></td>' +\n\t\t\t\t'<td><div class=\"ui input inline-edit changed-field\"><input class=\"external-number\" type=\"text\" data-value=\"\" value=\"\"></div></td>' +\n\t\t\t\t'<td><div class=\"ui input inline-edit changed-field\"><input class=\"external-aliases\" type=\"text\" data-value=\"\" value=\"\"></div></td>' +\n\t\t\t\t'<td><div class=\"ui small basic icon buttons action-buttons\">' +\n\t\t\t\t`<a href=\"#\" class=\"ui button delete two-steps-delete popuped\" data-value = \"new\" data-content=\"${globalTranslate.bt_ToolTipDelete}\">` +\n\t\t\t\t'<i class=\"icon trash red\"></i></a></div></td>' +\n\t\t\t\t'</tr>';\n\t\t\tModuleBitrix24Integration.$recordsTable.find('tbody > tr:first').before(rowTemplate);\n\t\t\t$(`tr#${id} input`).transition('glow');\n\t\t\t$(`tr#${id} .external-name`).focus();\n\t\t\tModuleBitrix24Integration.initializeInputmask($(`tr#${id} .external-number`));\n\t\t\tModuleBitrix24Integration.$dirrtyField.val(Math.random());\n\t\t\tModuleBitrix24Integration.$dirrtyField.trigger('change');\n\t\t});\n\n\t\t$('#open-cards-list option').each((index, obj) => {\n\t\t\t$(obj).html(globalTranslate[\"mod_b24_i_OPEN_CARD_\"+$(obj).val()]);\n\t\t});\n\t},\n\n\t/**\n\t * Подготавливает список выбора пользователей\n\t * @param selected\n\t * @returns {[]}\n\t */\n\tmakeDropdownList(selected) {\n\t\tconst values = [];\n\t\t$('#open-cards-list option').each((index, obj) => {\n\t\t\tif (selected === obj.text) {\n\t\t\t\tvalues.push({\n\t\t\t\t\tname: globalTranslate[\"mod_b24_i_OPEN_CARD_\"+obj.value],\n\t\t\t\t\tvalue: obj.value,\n\t\t\t\t\tselected: true,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvalues.push({\n\t\t\t\t\tname: globalTranslate[\"mod_b24_i_OPEN_CARD_\"+obj.value],\n\t\t\t\t\tvalue: obj.value,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn values;\n\t},\n\n\t/**\n\t * Обработка изменения группы в списке\n\t */\n\tchangeCardModeInList(value, text, $choice) {\n\t\tModuleBitrix24Integration.$dirrtyField.val(Math.random());\n\t\tModuleBitrix24Integration.$dirrtyField.trigger('change');\n\t\tModuleBitrix24Integration.onChangeField()\n\t},\n\n\t/**\n\t * Изменение статуса кнопок при изменении статуса модуля\n\t */\n\tcheckStatusToggle() {\n\t\tif (ModuleBitrix24Integration.$statusToggle.checkbox('is checked')) {\n\t\t\t$('[data-tab = \"general\"] .disability').removeClass('disabled');\n\t\t\t$('[data-tab = \"users\"]').removeClass('disabled');\n\t\t\t$('[data-tab = \"external_lines\"]').removeClass('disabled');\n\t\t\tModuleBitrix24Integration.$moduleStatus.show();\n\t\t\tModuleBitrix24IntegrationStatusWorker.initialize();\n\t\t} else {\n\t\t\tModuleBitrix24Integration.$moduleStatus.hide();\n\t\t\t$('[data-tab = \"general\"] .disability').addClass('disabled');\n\t\t\t$('[data-tab = \"users\"]').addClass('disabled');\n\t\t\t$('[data-tab = \"external_lines\"]').addClass('disabled');\n\t\t}\n\t},\n\n\t/**\n\t * Инициализирует красивое представление номеров\n\t */\n\tinitializeInputmask($el) {\n\t\tif (ModuleBitrix24Integration.$maskList === null) {\n\t\t\t// Подготовим таблицу для сортировки\n\t\t\tModuleBitrix24Integration.$maskList = $.masksSort(InputMaskPatterns, ['#'], /[0-9]|#/, 'mask');\n\t\t}\n\t\t$el.inputmasks({\n\t\t\tinputmask: {\n\t\t\t\tdefinitions: {\n\t\t\t\t\t'#': {\n\t\t\t\t\t\tvalidator: '[0-9]',\n\t\t\t\t\t\tcardinality: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tshowMaskOnHover: false,\n\t\t\t\t// oncleared: extension.cbOnClearedMobileNumber,\n\t\t\t\toncomplete: ModuleBitrix24Integration.cbOnCompleteNumber,\n\t\t\t\t// clearIncomplete: true,\n\t\t\t\tonBeforePaste: ModuleBitrix24Integration.cbOnNumberBeforePaste,\n\t\t\t\t// regex: /\\D+/,\n\t\t\t},\n\t\t\tmatch: /[0-9]/,\n\t\t\treplace: '9',\n\t\t\tlist: ModuleBitrix24Integration.$maskList,\n\t\t\tlistKey: 'mask',\n\n\t\t});\n\t},\n\t/**\n\t * Очистка номера перед вставкой от лишних символов\n\t * @returns {boolean|*|void|string}\n\t */\n\tcbOnNumberBeforePaste(pastedValue) {\n\t\treturn pastedValue.replace(/\\D+/g, '');\n\t},\n\t/**\n\t * После ввода номера\n\t */\n\tcbOnCompleteNumber(e){\n\t\tconst didEl = $(e.target).closest('tr').find('input.external-aliases');\n\t\tif (didEl.val()===''){\n\t\t\tdidEl.val($(e.target).inputmask('unmaskedvalue'));\n\t\t}\n\t},\n\t/**\n\t * Колбек перед отправкой формы\n\t * @param settings\n\t * @returns {*}\n\t */\n\tcbBeforeSendForm(settings) {\n\t\tconst result = settings;\n\t\tresult.data = ModuleBitrix24Integration.$formObj.form('get values');\n\n\t\tconst arrExternalLines = [];\n\t\t$('#external-line-table tr').each((index, obj) => {\n\t\t\tarrExternalLines.push({\n\t\t\t\tdisabled: $(obj).find('div.checkbox').checkbox('is checked') === false,\n\t\t\t\tid: $(obj).attr('id'),\n\t\t\t\tname: $(obj).find('input.external-name').val(),\n\t\t\t\tnumber: $(obj).find('input.external-number').val(),\n\t\t\t\talias: $(obj).find('input.external-aliases').val(),\n\t\t\t});\n\t\t});\n\t\tresult.data.externalLines = JSON.stringify(arrExternalLines);\n\t\tresult.data.portal = result.data.portal.replace(/^(https?|http):\\/\\//, '');\n\n\t\tconst arrUsers = [];\n\t\t$('#extensions-table tr').each((index, obj) => {\n\t\t\tlet uname = $(obj).find('td input[type=\"checkbox\"]').attr('name');\n\t\t\tif(uname === undefined){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tarrUsers.push({\n\t\t\t\tid: $(obj).attr('id'),\n\t\t\t\tuser_id: uname.replace('user-',''),\n\t\t\t\topen_card_mode: $(obj).find('td div.select-group').dropdown('get value'),\n\t\t\t\tdisabled: $(obj).find('td div.checkbox').checkbox('is unchecked'),\n\t\t\t});\n\t\t});\n\t\tresult.data.arrUsers = JSON.stringify(arrUsers);\n\t\treturn result;\n\t},\n\n\t/**\n\t * Колбек после отправки формы\n\t */\n\tcbAfterSendForm() {\n\t\tModuleBitrix24IntegrationStatusWorker.initialize();\n\t},\n\tinitializeForm() {\n\t\tForm.$formObj = ModuleBitrix24Integration.$formObj;\n\t\tForm.url = `${globalRootUrl}module-bitrix24-integration/save`;\n\t\tForm.validateRules = ModuleBitrix24Integration.validateRules;\n\t\tForm.cbBeforeSendForm = ModuleBitrix24Integration.cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = ModuleBitrix24Integration.cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n};\n\n$(document).ready(() => {\n\tModuleBitrix24Integration.initialize();\n});\n\n"],"file":"module-bitrix24-integration-index.js"}